(function(){define("jmpress",["jquery"],function(e){(function(e,t,n,i){function r(e){if(e){var t=1+e.substr(1).search(/[A-Z]/),n=e.substr(0,t).toLowerCase(),i=e.substr(t).toLowerCase();return"-"+n+"-"+i}}function s(e){return e?e+",":""}function o(r){function s(t,n){var i=c(t),r={oldStyle:e(t).attr("style")||""},s={data:i,stepData:r};u.call(this,"beforeInitStep",e(t),s),r.delegate=i.delegate,u.call(this,"initStep",e(t),s),e(t).data("stepData",r),e(t).attr("id")||e(t).attr("id","step-"+(n+1)),u.call(this,"applyStep",e(t),s)}function o(t){var n=e(t).data("stepData");e(t).attr("style",n.oldStyle),u.call(this,"unapplyStep",e(t),{stepData:n})}function a(t){u.call(this,"unapplyStep",e(t),{stepData:t.data("stepData")}),u.call(this,"applyStep",e(t),{stepData:t.data("stepData")})}function l(){I&&u.call(this,"setInactive",I,{stepData:e(I).data("stepData"),reason:"deinit"}),M.jmpressClass&&e(k).removeClass(M.jmpressClass),u.call(this,"beforeDeinit",e(this),{}),e(S.stepSelector,k).each(function(){o.call(k,this)}),L.attr("style",R.container),S.fullscreen&&e("html").attr("style",""),T.attr("style",R.area),e(_).children().each(function(){k.append(e(this))}),S.fullscreen?_.remove():(_.remove(),T.remove()),u.call(this,"afterDeinit",e(this),{}),e(k).data("jmpressmethods",!1)}function u(t,n,i){i.settings=S,i.current=M,i.container=L,i.parents=n?d(n):null,i.current=M,i.jmpress=this;var r={};return e.each(S[t],function(e,t){r.value=t.call(k,n,i)||r.value}),r.value}function d(t){return e(t).parentsUntil(k).not(k).filter(S.stepSelector)}function m(e){return p({step:I,substep:P},e)}function p(t,n){var r;if(e.isPlainObject(t)&&(r=t.substep,t=t.step),"string"==typeof t&&(t=k.find(t).first()),!t||!e(t).data("stepData"))return!1;F.call(this);var s=e(t).data("stepData"),o=!1;if(u.call(this,"beforeChange",t,{stepData:s,reason:n,cancel:function(){o=!0}}),o)return i;var a={},l=t;e(t).data("stepData").delegate&&(l=e(t).parentsUntil(k).filter(S.stepSelector).filter(s.delegate)||e(t).near(s.delegate)||e(t).near(s.delegate,!0)||e(s.delegate,k),s=l.data("stepData")),O&&u.call(this,"setInactive",O,{stepData:e(O).data("stepData"),delegatedFrom:I,reason:n,target:a,nextStep:l,nextSubstep:r,nextStepData:s});var h={stepData:s,delegatedFrom:t,reason:n,target:a,substep:r,prevStep:O,prevSubstep:P,prevStepData:O&&e(O).data("stepData")};return u.call(this,"beforeActive",l,h),u.call(this,"setActive",l,h),M.jmpressClass&&e(k).removeClass(M.jmpressClass),e(k).addClass(M.jmpressClass="step-"+e(l).attr("id")),M.jmpressDelegatedClass&&e(k).removeClass(M.jmpressDelegatedClass),e(k).addClass(M.jmpressDelegatedClass="delegating-step-"+e(t).attr("id")),u.call(this,"applyTarget",l,e.extend({canvas:_,area:T,beforeActive:O},h)),I=t,P=h.substep,O=l,M.idleTimeout&&clearTimeout(M.idleTimeout),M.idleTimeout=setTimeout(function(){u.call(this,"idle",l,h)},Math.max(1,S.transitionDuration-100)),l}function F(){function t(){function i(){(0!==e(L).scrollTop()||0!==e(L).scrollLeft())&&t()}if("BODY"===e(L)[0].tagName)try{n.scrollTo(0,0)}catch(r){}e(L).scrollTop(0),e(L).scrollLeft(0),setTimeout(i,1),setTimeout(i,10),setTimeout(i,100),setTimeout(i,200),setTimeout(i,400)}t()}function v(e){return p.call(this,e,"jump")}function C(){return p.call(this,u.call(this,"selectNext",I,{stepData:e(I).data("stepData"),substep:P}),"next")}function A(){return p.call(this,u.call(this,"selectPrev",I,{stepData:e(I).data("stepData"),substep:P}),"prev")}function E(){return p.call(this,u.call(this,"selectHome",I,{stepData:e(I).data("stepData")}),"home")}function w(){return p.call(this,u.call(this,"selectEnd",I,{stepData:e(I).data("stepData")}),"end")}function D(t){return h(_,t||{}),e(_)}function b(){return O&&e(O)}function y(t,n,r){return f[t]?u.call(this,t,n,r):(e.error("callback "+t+" is not registered."),i)}function B(){var e=navigator.userAgent.toLowerCase(),t=-1===e.search(/(iphone)|(ipod)|(android)/);return t}r=e.extend(!0,{},r||{});var x={},$=null;for($ in f)x[$]=e.isFunction(r[$])?[r[$]]:r[$],r[$]=[];var S=e.extend(!0,{},g,r);for($ in f)x[$]&&Array.prototype.push.apply(S[$],x[$]);var k=e(this),L=null,T=null,R={container:"",area:""},_=null,M=null,I=!1,P=null,O=!1;if(k.data("jmpressmethods",{select:p,reselect:m,scrollFix:F,goTo:v,next:C,prev:A,home:E,end:w,canvas:D,container:function(){return L},settings:function(){return S},active:b,current:function(){return M},fire:y,init:function(t){s.call(this,e(t),M.nextIdNumber++)},deinit:function(t){t?o.call(this,e(t)):l.call(this)},reapply:a}),B()===!1)return S.notSupportedClass&&k.addClass(S.notSupportedClass),i;S.notSupportedClass&&k.removeClass(S.notSupportedClass);var W=e(S.stepSelector,k);L=k,T=e("<div />"),_=e("<div />"),e(k).children().filter(W).each(function(){_.append(e(this))}),S.fullscreen&&(L=e("body"),e("html").css({overflow:"hidden"}),T=k),R.area=T.attr("style")||"",R.container=L.attr("style")||"",S.fullscreen?(L.css({height:"100%"}),k.append(_)):(L.css({position:"relative"}),T.append(_),k.append(T)),e(L).addClass(S.containerClass),e(T).addClass(S.areaClass),e(_).addClass(S.canvasClass),t.documentElement.style.height="100%",L.css({overflow:"hidden"});var N={position:"absolute",transitionDuration:"0s"};N=e.extend({},S.animation,N),h(T,N),h(T,{top:"50%",left:"50%",perspective:"1000px"}),h(_,N),M={},u.call(this,"beforeInit",null,{}),W.each(function(e){s.call(k,this,e)}),M.nextIdNumber=W.length,u.call(this,"afterInit",null,{}),p.call(this,u.call(this,"selectInitialStep","init",{})),S.initClass&&e(W).removeClass(S.initClass)}function a(){return g}function l(t,n){e.isFunction(n)?p[t]?e.error("function "+t+" is already registered."):p[t]=n:f[t]?e.error("callback "+t+" is already registered."):(f[t]=1,g[t]=[])}function h(t,n){var i,r,s={};for(i in n)n.hasOwnProperty(i)&&(r=d(i),null!==r&&(s[r]=n[i]));return e(t).css(s),t}function c(t){function n(e){e=e.split("-");for(var t=1;e.length>t;t++)e[t]=e[t].substr(0,1).toUpperCase()+e[t].substr(1);return e.join("")}if(e(t)[0].dataset)return e.extend({},e(t)[0].dataset);var i={},r=e(t)[0].attributes;return e.each(r,function(e,t){"data-"===t.nodeName.substr(0,5)&&(i[n(t.nodeName.substr(5))]=t.nodeValue)}),i}function u(){return!!e(this).data("jmpressmethods")}var d=function(){var e=t.createElement("dummy").style,n="Webkit Moz O ms Khtml".split(" "),r={};return function(t){if(r[t]===i){var s=t.charAt(0).toUpperCase()+t.substr(1),o=(t+" "+n.join(s+" ")+s).split(" ");r[t]=null;for(var a in o)if(e[o[a]]!==i){r[t]=o[a];break}}return r[t]}}(),g={stepSelector:".step",containerClass:"",canvasClass:"",areaClass:"",notSupportedClass:"not-supported",fullscreen:!0,animation:{transformOrigin:"top left",transitionProperty:s(r(d("transform")))+s(r(d("perspective")))+"opacity",transitionDuration:"1s",transitionDelay:"500ms",transitionTimingFunction:"ease-in-out",transformStyle:"preserve-3d"},transitionDuration:1500},f={beforeChange:1,beforeInitStep:1,initStep:1,beforeInit:1,afterInit:1,beforeDeinit:1,afterDeinit:1,applyStep:1,unapplyStep:1,setInactive:1,beforeActive:1,setActive:1,selectInitialStep:1,selectPrev:1,selectNext:1,selectHome:1,selectEnd:1,idle:1,applyTarget:1};for(var m in f)g[m]=[];var p={init:o,initialized:u,deinit:function(){},css:h,pfx:d,defaults:a,register:l,dataset:c};e.fn.jmpress=function(t){function n(){var n=e(this).data("jmpressmethods");if(n&&n[t])return n[t].apply(this,Array.prototype.slice.call(arguments,1));if(p[t])return p[t].apply(this,Array.prototype.slice.call(arguments,1));if(f[t]&&n){var i=n.settings(),r=Array.prototype.slice.call(arguments,1)[0];e.isFunction(r)&&(i[t]=i[t]||[],i[t].push(r))}else{if("object"==typeof t||!t)return o.apply(this,arguments);e.error("Method "+t+" does not exist on jQuery.jmpress")}return this}var i,r=arguments;return e(this).each(function(e,t){i=n.apply(t,r)}),i},e.extend({jmpress:function(t){if(p[t])return p[t].apply(this,Array.prototype.slice.call(arguments,1));if(f[t]){var n=Array.prototype.slice.call(arguments,1)[0];e.isFunction(n)?g[t].push(n):e.error("Second parameter should be a function: $.jmpress( callbackName, callbackFunction )")}else e.error("Method "+t+" does not exist on jQuery.jmpress")}})})(e,document,window),function(e){function t(t,n,i,r){var s;return t.each(function(t,o){return r&&(s=n(o,i,r))?!1:e(o).is(i)?(s=o,!1):!r&&(s=n(o,i,r))?!1:undefined}),s}function n(i,r,s){var o=e(i).children();return s&&(o=e(o.get().reverse())),t(o,n,r,s)}function i(i,r,s){return t(e(i)[s?"prevAll":"nextAll"](),n,r,s)}function r(t,n,r){var s,o=e(t).parents();return o=e(o.get()),e.each(o.get(),function(t,o){return r&&e(o).is(n)?(s=o,!1):(s=i(o,n,r),s?!1:undefined)}),s}e.fn.near=function(t,s){var o=[];return e(this).each(function(e,a){var l=(s?!1:n(a,t,s))||i(a,t,s)||r(a,t,s);l&&o.push(l)}),e(o)}}(e,document,window),function(e,t,n,i){function r(e){return Math.round(1e4*e)/1e4+""}var s={3:{transform:function(t,n){var i="translate(-50%,-50%)";e.each(n,function(e,t){var n,s=["X","Y","Z"];if("translate"===t[0])i+=" translate3d("+r(t[1]||0)+"px,"+r(t[2]||0)+"px,"+r(t[3]||0)+"px)";else if("rotate"===t[0]){var o=t[4]?[1,2,3]:[3,2,1];for(n=0;3>n;n++)i+=" rotate"+s[o[n]-1]+"("+r(t[o[n]]||0)+"deg)"}else if("scale"===t[0])for(n=0;3>n;n++)i+=" scale"+s[n]+"("+r(t[n+1]||1)+")"}),e.jmpress("css",t,e.extend({},{transform:i}))}},2:{transform:function(t,n){var i="translate(-50%,-50%)";e.each(n,function(e,t){var n=["X","Y"];if("translate"===t[0])i+=" translate("+r(t[1]||0)+"px,"+r(t[2]||0)+"px)";else if("rotate"===t[0])i+=" rotate("+r(t[3]||0)+"deg)";else if("scale"===t[0])for(var s=0;2>s;s++)i+=" scale"+n[s]+"("+r(t[s+1]||1)+")"}),e.jmpress("css",t,e.extend({},{transform:i}))}},1:{transform:function(t,n){var i={top:0,left:0};e.each(n,function(e,t){"translate"===t[0]&&(i.left=Math.round(t[1]||0)+"px",i.top=Math.round(t[2]||0)+"px")}),t.animate(i,1e3)}}},o=function(){return e.jmpress("pfx","perspective")?s[3]:e.jmpress("pfx","transform")?s[2]:s[1]}();e.jmpress("defaults").reasonableAnimation={},e.jmpress("initStep",function(t,n){var i=n.data,r=n.stepData,s=parseFloat;e.extend(r,{x:s(i.x)||0,y:s(i.y)||0,z:s(i.z)||0,r:s(i.r)||0,phi:s(i.phi)||0,rotate:s(i.rotate)||0,rotateX:s(i.rotateX)||0,rotateY:s(i.rotateY)||0,rotateZ:s(i.rotateZ)||0,revertRotate:!1,scale:s(i.scale)||1,scaleX:s(i.scaleX)||!1,scaleY:s(i.scaleY)||!1,scaleZ:s(i.scaleZ)||1})}),e.jmpress("afterInit",function(t,n){var i=n.settings.stepSelector,r=n.current;r.perspectiveScale=1,r.maxNestedDepth=0;for(var s=e(n.jmpress).find(i).children(i);s.length;)r.maxNestedDepth++,s=s.children(i)}),e.jmpress("applyStep",function(t,n){e.jmpress("css",e(t),{position:"absolute",transformStyle:"preserve-3d"}),n.parents.length>0&&e.jmpress("css",e(t),{top:"50%",left:"50%"});var i=n.stepData,r=[["translate",i.x||i.r*Math.sin(i.phi*Math.PI/180),i.y||-i.r*Math.cos(i.phi*Math.PI/180),i.z],["rotate",i.rotateX,i.rotateY,i.rotateZ||i.rotate,!0],["scale",i.scaleX||i.scale,i.scaleY||i.scale,i.scaleZ||i.scale]];o.transform(t,r)}),e.jmpress("setActive",function(t,n){var r=n.target,s=n.stepData,o=r.transform=[];r.perspectiveScale=1;for(var a=n.current.maxNestedDepth;a>(n.parents.length||0);a--)o.push(["scale"],["rotate"],["translate"]);o.push(["scale",1/(s.scaleX||s.scale),1/(s.scaleY||s.scale),1/s.scaleZ]),o.push(["rotate",-s.rotateX,-s.rotateY,-(s.rotateZ||s.rotate)]),o.push(["translate",-(s.x||s.r*Math.sin(s.phi*Math.PI/180)),-(s.y||-s.r*Math.cos(s.phi*Math.PI/180)),-s.z]),r.perspectiveScale*=s.scaleX||s.scale,e.each(n.parents,function(t,n){var i=e(n).data("stepData");o.push(["scale",1/(i.scaleX||i.scale),1/(i.scaleY||i.scale),1/i.scaleZ]),o.push(["rotate",-i.rotateX,-i.rotateY,-(i.rotateZ||i.rotate)]),o.push(["translate",-(i.x||i.r*Math.sin(i.phi*Math.PI/180)),-(i.y||-i.r*Math.cos(i.phi*Math.PI/180)),-i.z]),r.perspectiveScale*=i.scaleX||i.scale}),e.each(o,function(e,t){function r(r){n.current["rotate"+r+"-"+e]===i&&(n.current["rotate"+r+"-"+e]=t[r]||0);var s=n.current["rotate"+r+"-"+e],o=t[r]||0,a=s%360,l=o%360;0>a&&(a+=360),0>l&&(l+=360);var h=l-a;-180>h?h+=360:h>180&&(h-=360),n.current["rotate"+r+"-"+e]=t[r]=s+h}"rotate"===t[0]&&(r(1),r(2),r(3))})}),e.jmpress("applyTarget",function(t,n){var r,s=n.target,a=(n.stepData,n.settings),l=1.3*s.perspectiveScale<n.current.perspectiveScale,h=s.perspectiveScale>1.3*n.current.perspectiveScale,c=-1;e.each(s.transform,function(e,t){return 1>=t.length||"rotate"===t[0]&&0===t[1]%360&&0===t[2]%360&&0===t[3]%360?i:"scale"!==t[0]?!1:(c=e,i)}),c!==n.current.oldLastScale&&(l=h=!1,n.current.oldLastScale=c);var u=[];if(-1!==c)for(;c>=0;)"scale"===s.transform[c][0]&&(u.push(s.transform[c]),s.transform[c]=["scale"]),c--;var d=a.animation;a.reasonableAnimation[n.reason]&&(d=e.extend({},d,a.reasonableAnimation[n.reason])),r={perspective:Math.round(1e3*s.perspectiveScale)+"px"},r=e.extend({},d,r),l||(r.transitionDelay="0s"),n.beforeActive||(r.transitionDuration="0s",r.transitionDelay="0s"),e.jmpress("css",n.area,r),o.transform(n.area,u),r=e.extend({},d),h||(r.transitionDelay="0s"),n.beforeActive||(r.transitionDuration="0s",r.transitionDelay="0s"),n.current.perspectiveScale=s.perspectiveScale,e.jmpress("css",n.canvas,r),o.transform(n.canvas,s.transform)})}(e,document,window),function(e){var t=e.jmpress,n="activeClass",i="nestedActiveClass",r=t("defaults");r[i]="nested-active",r[n]="active",t("setInactive",function(t,r){var s=r.settings,o=s[n],a=s[i];o&&e(t).removeClass(o),a&&e.each(r.parents,function(t,n){e(n).removeClass(a)})}),t("setActive",function(t,r){var s=r.settings,o=s[n],a=s[i];o&&e(t).addClass(o),a&&e.each(r.parents,function(t,n){e(n).addClass(a)})})}(e,document,window),function(e){function t(t,n){return e(this).find(n.settings.stepSelector).first()}function n(t,n,i,r){if(!n)return!1;var s=i.settings.stepSelector;n=e(n);do{var o=n.near(s,r);if((0===o.length||0===o.closest(t).length)&&(o=e(t).find(s)[r?"last":"first"]()),!o.length)return!1;n=o}while(n.data("stepData").exclude);return n}var i=e.jmpress;i("initStep",function(e,t){t.stepData.exclude=t.data.exclude&&-1===["false","no"].indexOf(t.data.exclude)}),i("selectInitialStep",t),i("selectHome",t),i("selectEnd",function(t,n){return e(this).find(n.settings.stepSelector).last()}),i("selectPrev",function(e,t){return n(this,e,t,!0)}),i("selectNext",function(e,t){return n(this,e,t)})}(e,document,window),function(e){function t(t,n,i){for(var r=0;n.length-1>r;r++){var s=n[r],o=n[r+1];e(t).jmpress("initialized")?e(s,t).data("stepData")[i]=o:e(s,t).attr("data-"+i,o)}}function n(t,n,i,r){var s=n.stepData;if(s[i]){var o=e(t).near(s[i],r);if(o&&o.length)return o;if(o=e(s[i],this)[r?"last":"first"](),o&&o.length)return o}}var i=e.jmpress;i("register","route",function(e,n,i){"string"==typeof e&&(e=[e,e]),t(this,e,i?"prev":"next"),n||t(this,e.reverse(),i?"next":"prev")}),i("initStep",function(e,t){for(var n in{next:1,prev:1})t.stepData[n]=t.data[n]}),i("selectNext",function(e,t){return n.call(this,e,t,"next")}),i("selectPrev",function(e,t){return n.call(this,e,t,"prev",!0)})}(e,document,window),function(e,t,n,i){function r(){return""+Math.round(1e5*Math.random(),0)}function s(t){try{var r=e("#"+n.location.hash.replace(/^#\/?/,""));return r.length>0&&r.is(t.stepSelector)?r:i}catch(s){}}function o(e){var t="#/"+e;n.history&&n.history.pushState?n.location.hash!==t&&n.history.pushState({},"",t):n.location.hash!==t&&(n.location.hash=t)}var a=e.jmpress,l="a[href^=#]";a("defaults").hash={use:!0,update:!0,bindChange:!0},a("selectInitialStep",function(t,a){var h=a.settings,c=h.hash,u=a.current,d=e(this);return a.current.hashNamespace=".jmpress-"+r(),c.use?(c.bindChange&&(e(n).bind("hashchange"+u.hashNamespace,function(e){var t=s(h);d.jmpress("initialized")&&d.jmpress("scrollFix"),t&&t.length&&(t.attr("id")!==d.jmpress("active").attr("id")&&d.jmpress("select",t),o(t.attr("id"))),e.preventDefault()}),e(l).on("click"+u.hashNamespace,function(t){var n=e(this).attr("href");try{e(n).is(h.stepSelector)&&(d.jmpress("select",n),t.preventDefault(),t.stopPropagation())}catch(i){}})),s(h)):i}),a("afterDeinit",function(t,i){e(l).off(i.current.hashNamespace),e(n).unbind(i.current.hashNamespace)}),a("setActive",function(t,n){var i=n.settings,r=n.current;i.hash.use&&i.hash.update&&(clearTimeout(r.hashtimeout),r.hashtimeout=setTimeout(function(){o(e(n.delegatedFrom).attr("id"))},i.transitionDuration+200))})}(e,document,window),function(e,t,n,i){function r(){return""+Math.round(1e5*Math.random(),0)}function s(e){e.preventDefault(),e.stopPropagation()}var o=e.jmpress,a="next",l="prev";o("defaults").keyboard={use:!0,keys:{33:l,37:l,38:l,9:a+":"+l,32:a,34:a,39:a,40:a,36:"home",35:"end"},ignore:{INPUT:[32,37,38,39,40],TEXTAREA:[32,37,38,39,40],SELECT:[38,40]},tabSelector:"a[href]:visible, :input:visible"},o("afterInit",function(n,o){var a=o.settings,l=a.keyboard,h=l.ignore,c=o.current,u=e(this);a.fullscreen||u.attr("tabindex",0),c.keyboardNamespace=".jmpress-"+r(),e(a.fullscreen?t:u).bind("keypress"+c.keyboardNamespace,function(e){for(var t in h)if(e.target.nodeName===t&&-1!==h[t].indexOf(e.which))return;(e.which>=37&&40>=e.which||32===e.which)&&s(e)}),e(a.fullscreen?t:u).bind("keydown"+c.keyboardNamespace,function(t){var n=e(t.target);if((a.fullscreen||n.closest(u).length)&&l.use){for(var r in h)if(n[0].nodeName===r&&-1!==h[r].indexOf(t.which))return;var o,c=!1;if(9===t.which){if(n.closest(u.jmpress("active")).length?(o=n.near(l.tabSelector,t.shiftKey),e(o).closest(a.stepSelector).is(u.jmpress("active"))||(o=i)):t.shiftKey?c=!0:o=u.jmpress("active").find("a[href], :input").filter(":visible").first(),o&&o.length>0)return o.focus(),u.jmpress("scrollFix"),s(t),i;t.shiftKey&&(c=!0)}var d=l.keys[t.which];"string"==typeof d?(-1!==d.indexOf(":")&&(d=d.split(":"),d=t.shiftKey?d[1]:d[0]),u.jmpress(d),s(t)):e.isFunction(d)?d.call(u,t):d&&(u.jmpress.apply(u,d),s(t)),c&&(o=u.jmpress("active").find("a[href], :input").filter(":visible").last(),o.focus(),u.jmpress("scrollFix"))}})}),o("afterDeinit",function(n,i){e(t).unbind(i.current.keyboardNamespace)})}(e,document,window),function(e,t,n,i){function r(){return""+Math.round(1e5*Math.random(),0)}function s(e,t){return Math.max(Math.min(e,t),-t)}function o(t,n,i){var r=e(this).jmpress("current"),o=e(this).jmpress("settings"),a=e(this).jmpress("active").data("stepData"),l=e(this).jmpress("container");if(!(0===r.userZoom&&0>i)){var h=a.viewPortZoomable||o.viewPort.zoomable;if(!(r.userZoom===h&&i>0)){r.userZoom+=i;var c=e(l).innerWidth()/2,u=e(l).innerHeight()/2;t=t?t-c:t,n=n?n-u:n,r.userTranslateX=s(r.userTranslateX-i*t/r.zoomOriginWindowScale/h,c*r.userZoom*r.userZoom/h),r.userTranslateY=s(r.userTranslateY-i*n/r.zoomOriginWindowScale/h,u*r.userZoom*r.userZoom/h),e(this).jmpress("reselect","zoom")}}}var a=e.jmpress("defaults");a.viewPort={width:!1,height:!1,maxScale:0,minScale:0,zoomable:0,zoomBindMove:!0,zoomBindWheel:!0};var l=a.keyboard.keys;l[e.browser.mozilla?107:187]="zoomIn",l[e.browser.mozilla?109:189]="zoomOut",a.reasonableAnimation.resize={transitionDuration:"0s",transitionDelay:"0ms"},a.reasonableAnimation.zoom={transitionDuration:"0s",transitionDelay:"0ms"},e.jmpress("initStep",function(e,t){for(var n in{viewPortHeight:1,viewPortWidth:1,viewPortMinScale:1,viewPortMaxScale:1,viewPortZoomable:1})t.stepData[n]=t.data[n]&&parseFloat(t.data[n])}),e.jmpress("afterInit",function(s,o){var a=this;o.current.viewPortNamespace=".jmpress-"+r(),e(n).bind("resize"+o.current.viewPortNamespace,function(){e(a).jmpress("reselect","resize")}),o.current.userZoom=0,o.current.userTranslateX=0,o.current.userTranslateY=0,o.settings.viewPort.zoomBindWheel&&e(o.settings.fullscreen?t:this).bind("mousewheel"+o.current.viewPortNamespace+" DOMMouseScroll"+o.current.viewPortNamespace,function(t,n){n=n||t.originalEvent.wheelDelta||-t.originalEvent.detail;var i=n/Math.abs(n);return 0>i?e(o.jmpress).jmpress("zoomOut",t.originalEvent.x,t.originalEvent.y):i>0&&e(o.jmpress).jmpress("zoomIn",t.originalEvent.x,t.originalEvent.y),!1}),o.settings.viewPort.zoomBindMove&&e(o.settings.fullscreen?t:this).bind("mousedown"+o.current.viewPortNamespace,function(e){o.current.userZoom&&(o.current.userTranslating={x:e.clientX,y:e.clientY},e.preventDefault(),e.stopImmediatePropagation())}).bind("mousemove"+o.current.viewPortNamespace,function(t){var n=o.current.userTranslating;n&&(e(a).jmpress("zoomTranslate",t.clientX-n.x,t.clientY-n.y),n.x=t.clientX,n.y=t.clientY,t.preventDefault(),t.stopImmediatePropagation())}).bind("mouseup"+o.current.viewPortNamespace,function(e){o.current.userTranslating&&(o.current.userTranslating=i,e.preventDefault(),e.stopImmediatePropagation())})}),e.jmpress("register","zoomIn",function(e,t){o.call(this,e||0,t||0,1)}),e.jmpress("register","zoomOut",function(e,t){o.call(this,e||0,t||0,-1)}),e.jmpress("register","zoomTranslate",function(t,n){var i=e(this).jmpress("current"),r=e(this).jmpress("settings"),o=e(this).jmpress("active").data("stepData"),a=e(this).jmpress("container"),l=o.viewPortZoomable||r.viewPort.zoomable,h=e(a).innerWidth(),c=e(a).innerHeight();i.userTranslateX=s(i.userTranslateX+t/i.zoomOriginWindowScale,h*i.userZoom*i.userZoom/l),i.userTranslateY=s(i.userTranslateY+n/i.zoomOriginWindowScale,c*i.userZoom*i.userZoom/l),e(this).jmpress("reselect","zoom")}),e.jmpress("afterDeinit",function(t,i){e(n).unbind(i.current.viewPortNamespace)}),e.jmpress("setActive",function(t,n){var i=n.settings.viewPort,r=n.stepData.viewPortHeight||i.height,s=n.stepData.viewPortWidth||i.width,o=n.stepData.viewPortMaxScale||i.maxScale,a=n.stepData.viewPortMinScale||i.minScale,l=r&&e(n.container).innerHeight()/r,h=s&&e(n.container).innerWidth()/s,c=(h||l)&&Math.min(h||l,l||h);if(c){c=c||1,o&&(c=Math.min(c,o)),a&&(c=Math.max(c,a));var u=n.stepData.viewPortZoomable||n.settings.viewPort.zoomable;if(u){var d=1/c-1/o;d/=u,c=1/(1/c-d*n.current.userZoom)}n.target.transform.reverse(),n.current.userTranslateX&&n.current.userTranslateY?n.target.transform.push(["translate",n.current.userTranslateX,n.current.userTranslateY,0]):n.target.transform.push(["translate"]),n.target.transform.push(["scale",c,c,1]),n.target.transform.reverse(),n.target.perspectiveScale/=c}n.current.zoomOriginWindowScale=c}),e.jmpress("setInactive",function(t,n){n.nextStep&&t&&e(n.nextStep).attr("id")===e(t).attr("id")||(n.current.userZoom=0,n.current.userTranslateX=0,n.current.userTranslateY=0)})}(e,document,window),function(e){function t(){return""+Math.round(1e5*Math.random(),0)}var n=e.jmpress;n("defaults").mouse={clickSelects:!0},n("afterInit",function(n,i){var r=i.settings,s=r.stepSelector,o=i.current,a=e(this);o.clickableStepsNamespace=".jmpress-"+t(),a.bind("click"+o.clickableStepsNamespace,function(t){if(r.mouse.clickSelects&&!o.userZoom){var n=e(t.target).closest(s);n.is(a.jmpress("active"))||n.length&&(a.jmpress("select",n[0],"click"),t.preventDefault(),t.stopPropagation())}})}),n("afterDeinit",function(t,n){e(this).unbind(n.current.clickableStepsNamespace)})}(e,document,window),function(e,t){function n(){return""+Math.round(1e5*Math.random(),0)}var i=e.jmpress;i("afterInit",function(i,r){var s=r.settings,o=r.current,a=r.jmpress;o.mobileNamespace=".jmpress-"+n();var l,h=[0,0];e(s.fullscreen?t:a).bind("touchstart"+o.mobileNamespace,function(e){l=e.originalEvent.touches[0],h=[l.pageX,l.pageY]}).bind("touchmove"+o.mobileNamespace,function(e){return l=e.originalEvent.touches[0],e.preventDefault(),!1}).bind("touchend"+o.mobileNamespace,function(t){var n=[l.pageX,l.pageY],i=[n[0]-h[0],n[1]-h[1]];return Math.max(Math.abs(i[0]),Math.abs(i[1]))>50?(i=Math.abs(i[0])>Math.abs(i[1])?i[0]:i[1],e(a).jmpress(i>0?"prev":"next"),t.preventDefault(),!1):undefined})}),i("afterDeinit",function(n,i){var r=i.settings,s=i.current,o=i.jmpress;e(r.fullscreen?t:o).unbind(s.mobileNamespace)})}(e,document,window),function(e,t,n,i){function r(t,n,s){for(var o in n){var a=o;s&&(a=s+a.substr(0,1).toUpperCase()+a.substr(1)),e.isPlainObject(n[o])?r(t,n[o],a):t[a]===i&&(t[a]=n[o])}}function s(t,n){e.isArray(n)?n.length<t.length?e.error("more nested steps than children in template"):t.each(function(t,i){i=e(i);var s=i.data(h)||{};r(s,n[t]),i.data(h,s)}):e.isFunction(n)&&t.each(function(i,s){s=e(s);var o=s.data(h)||{};r(o,n(i,s,t)),s.data(h,o)})}function o(e,t,n,i){if(n.children){var r=t.children(i.settings.stepSelector);s(r,n.children)}a(e,n)}function a(e,t){r(e,t)}var l=e.jmpress,h="_template_",c="_applied_template_",u={};l("beforeInitStep",function(t,n){t=e(t);var i=n.data,r=i.template,s=t.data(c),a=t.data(h);r&&e.each(r.split(" "),function(e,r){var s=u[r];o(i,t,s,n)}),s&&o(i,t,s,n),a&&(o(i,t,a,n),t.data(h,null),a.template&&e.each(a.template.split(" "),function(e,r){var s=u[r];o(i,t,s,n)}))}),l("beforeInit",function(t,n){var i=l("dataset",this),r=i.template,o=n.settings.stepSelector;if(r){var a=u[r];s(e(this).find(o).filter(function(){return!e(this).parent().is(o)}),a.children)}}),l("register","template",function(t,n){u[t]=u[t]?e.extend(!0,{},u[t],n):e.extend(!0,{},n)}),l("register","apply",function(t,n){if(n)if(e.isArray(n))s(e(t),n);else{var i;i="string"==typeof n?u[n]:e.extend(!0,{},n),e(t).each(function(t,n){n=e(n);var s=n.data(c)||{};r(s,i),n.data(c,s)})}else{var o=e(this).jmpress("settings").stepSelector;s(e(this).find(o).filter(function(){return!e(this).parent().is(o)}),t)}})}(e,document,window),function(e){e.jmpress("setActive",function(t,n){n.prevStep!==t&&e(t).triggerHandler("enterStep")}),e.jmpress("setInactive",function(t,n){n.nextStep!==t&&e(t).triggerHandler("leaveStep")})}(e,document,window),function(e,t,n,i){function r(t){for(var n=t.split(" "),i=n[0],r={willClass:"will-"+i,doClass:"do-"+i,hasClass:"has-"+i},s="",o=1;n.length>o;o++){var a=n[o];switch(s){case"":"after"===a?s="after":e.warn("unknown keyword in '"+t+"'. '"+a+"' unknown.");break;case"after":if(a.match(/^[1-9][0-9]*m?s?/)){var l=parseFloat(a);-1!==a.indexOf("ms")?l*=1:-1!==a.indexOf("s")?l*=1e3:-1!==a.indexOf("m")&&(l*=6e4),r.delay=l}else r.after=Array.prototype.slice.call(n,o).join(" ")}}return r}function s(t,n,i,r){r=r||t.length-1,i=i||0;for(var s=i;r+1>s;s++)if(e(t[s].element).is(n))return s}function o(t,n,i){e.each(n._on,function(e,n){t.push({substep:n.substep,delay:n.delay+i}),o(t,n.substep,n.delay+i)})}e.jmpress("defaults").customAnimationDataAttribute="jmpress",e.jmpress("afterInit",function(e,t){t.current.animationTimeouts=[],t.current.animationCleanupWaiting=[]}),e.jmpress("applyStep",function(t,n){function a(e,t){return t.substep._after?(c=t.substep._after,!1):i}var l={},h=[];if(e(t).find("[data-"+n.settings.customAnimationDataAttribute+"]").each(function(i,r){e(r).closest(n.settings.stepSelector).is(t)&&h.push({element:r})}),0!==h.length){e.each(h,function(t,i){i.info=r(e(i.element).data(n.settings.customAnimationDataAttribute)),e(i.element).addClass(i.info.willClass),i._on=[],i._after=null});var c={_after:i,_on:[],info:{}};if(e.each(h,function(e,t){var n=t.info.after;if(n)if("step"===n)n=c;else if("prev"===n)n=h[e-1];else{var r=s(h,n,0,e-1);-1===r&&(r=s(h,n)),n=-1===r||r===e?h[e-1]:h[r]}else n=h[e-1];if(n){if(!t.info.delay){if(!n._after)return n._after=t,i;n=n._after}n._on.push({substep:t,delay:t.info.delay||0})}}),c._after===i&&0===c._on.length){var u=s(h,n.stepData.startSubstep)||0;c._after=h[u]}var d=[];do{var g=[{substep:c,delay:0}];o(g,c,0),d.push(g),c=null,e.each(g,a)}while(c);l.list=d,e(t).data("substepsData",l)}}),e.jmpress("unapplyStep",function(t){var n=e(t).data("substepsData");n&&e.each(n.list,function(t,n){e.each(n,function(t,n){n.substep.info.willClass&&e(n.substep.element).removeClass(n.substep.info.willClass),n.substep.info.hasClass&&e(n.substep.element).removeClass(n.substep.info.hasClass),n.substep.info.doClass&&e(n.substep.element).removeClass(n.substep.info.doClass)})})}),e.jmpress("setActive",function(t,n){var r=e(t).data("substepsData");if(r){n.substep===i&&(n.substep="prev"===n.reason?r.list.length-1:0);var s=n.substep;e.each(n.current.animationTimeouts,function(e,t){clearTimeout(t)}),n.current.animationTimeouts=[],e.each(r.list,function(t,i){var r=s>t,o=s>=t;e.each(i,function(t,i){function s(){e(i.substep.element).addClass(i.substep.info.doClass)}i.substep.info.hasClass&&e(i.substep.element)[(r?"add":"remove")+"Class"](i.substep.info.hasClass),o&&!r&&i.delay&&"prev"!==n.reason?i.substep.info.doClass&&(e(i.substep.element).removeClass(i.substep.info.doClass),n.current.animationTimeouts.push(setTimeout(s,i.delay))):i.substep.info.doClass&&e(i.substep.element)[(o?"add":"remove")+"Class"](i.substep.info.doClass)})})}}),e.jmpress("setInactive",function(t,n){function i(t){e.each(t.list,function(t,n){e.each(n,function(t,n){n.substep.info.hasClass&&e(n.substep.element).removeClass(n.substep.info.hasClass),n.substep.info.doClass&&e(n.substep.element).removeClass(n.substep.info.doClass)})})}if(n.nextStep!==t){e.each(n.current.animationCleanupWaiting,function(e,t){i(t)}),n.current.animationCleanupWaiting=[];var r=e(t).data("substepsData");r&&n.current.animationCleanupWaiting.push(r)}}),e.jmpress("selectNext",function(t,n){if(n.substep!==i){var r=e(t).data("substepsData");if(r)return n.substep<r.list.length-1?{step:t,substep:n.substep+1}:i}}),e.jmpress("selectPrev",function(t,n){if(n.substep!==i){var r=e(t).data("substepsData");if(r)return n.substep>0?{step:t,substep:n.substep-1}:i}})}(e,document,window),function(e,t){e.jmpress("register","toggle",function(n,i,r){var s=this;e(t).bind("keydown",function(t){t.keyCode===n&&(e(s).jmpress("initialized")?e(s).jmpress("deinit"):e(s).jmpress(i))}),r&&e(s).jmpress(i)})}(e,document,window),function(e){function t(t,n,i){if(t.secondary&&-1!==t.secondary.split(" ").indexOf(n)){for(var r in t)if(r.length>9&&0===r.indexOf("secondary")){var s=t[r],o=r.substr(9);o=o.substr(0,1).toLowerCase()+o.substr(1),t[r]=t[o],t[o]=s}e(this).jmpress("reapply",e(i))}}e.jmpress("initStep",function(e,t){for(var n in t.data)0===n.indexOf("secondary")&&(t.stepData[n]=t.data[n])}),e.jmpress("beforeActive",function(n,i){t.call(i.jmpress,e(n).data("stepData"),"self",n);var r=e(n).parent();e(r).children(i.settings.stepSelector).each(function(n,r){var s=e(r).data("stepData");t.call(i.jmpress,s,"siblings",r)});for(var s=1;i.parents.length>s;s++)e(i.parents[s]).children(i.settings.stepSelector).each()}),e.jmpress("setInactive",function(n,i){function r(n,r){var s=e(r).data("stepData");t.call(i.jmpress,s,"grandchildren",r)}t.call(i.jmpress,e(n).data("stepData"),"self",n);var s=e(n).parent();e(s).children(i.settings.stepSelector).each(function(n,r){var s=e(r).data("stepData");t.call(i.jmpress,s,"siblings",r)});for(var o=1;i.parents.length>o;o++)e(i.parents[o]).children(i.settings.stepSelector).each(r)})}(e,document,window),function(e,t,n,i){e.jmpress("defaults").duration={defaultValue:-1,defaultAction:"next",barSelector:i,barProperty:"width",barPropertyStart:"0",barPropertyEnd:"100%"},e.jmpress("initStep",function(e,t){t.stepData.duration=t.data.duration&&parseInt(t.data.duration,10),t.stepData.durationAction=t.data.durationAction}),e.jmpress("setInactive",function(t,n){var r=n.settings,s=r.duration,o=n.current,a=n.stepData.duration||s.defaultValue;if(a&&a>0){if(s.barSelector){var l={transitionProperty:s.barProperty,transitionDuration:"0",transitionDelay:"0",transitionTimingFunction:"linear"};l[s.barProperty]=s.barPropertyStart;var h=e(s.barSelector);e.jmpress("css",h,l),h.each(function(t,n){var i=e(n).next(),r=e(n).parent();e(n).detach(),i.length?i.insertBefore(n):r.append(n)})}o.durationTimeout&&(clearTimeout(o.durationTimeout),o.durationTimeout=i)}}),e.jmpress("setActive",function(t,n){var r=n.settings,s=r.duration,o=n.current,a=n.stepData.duration||s.defaultValue;if(a&&a>0){if(s.barSelector){var l={transitionProperty:s.barProperty,transitionDuration:a-2*r.transitionDuration/3-100+"ms",transitionDelay:2*r.transitionDuration/3+"ms",transitionTimingFunction:"linear"};l[s.barProperty]=s.barPropertyEnd,e.jmpress("css",e(s.barSelector),l)}var h=this;o.durationTimeout&&(clearTimeout(o.durationTimeout),o.durationTimeout=i),o.durationTimeout=setTimeout(function(){var t=n.stepData.durationAction||s.defaultAction;e(h).jmpress(t)},a)}})}(e,document,window),function(e,t,n){var i=e.jmpress;i("defaults").presentationMode={use:!0,url:"presentation-screen.html",notesUrl:!1,transferredValues:["userZoom","userTranslateX","userTranslateY"]},i("defaults").keyboard.keys[80]="presentationPopup",i("afterInit",function(t,i){var r=i.current;
if(r.selectMessageListeners=[],i.settings.presentationMode.use){n.addEventListener("message",function(t){try{var s=JSON.parse(t.data);switch(s.type){case"select":e.each(i.settings.presentationMode.transferredValues,function(e,t){i.current[t]=s[t]}),e(i.jmpress).jmpress("select",{step:"#"+s.targetId,substep:s.substep},s.reason);break;case"listen":r.selectMessageListeners.push(t.source);break;case"ok":clearTimeout(r.presentationPopupTimeout);break;case"read":try{t.source.postMessage(JSON.stringify({type:"url",url:n.location.href,notesUrl:i.settings.presentationMode.notesUrl}),"*")}catch(o){e.error("Cannot post message to source: "+o)}break;default:throw"Unknown message type: "+s.type}}catch(o){e.error("Recieved message is malformed: "+o)}});try{n.parent&&n.parent!==n&&n.parent.postMessage(JSON.stringify({type:"afterInit"}),"*")}catch(s){e.error("Cannot post message to parent: "+s)}}}),i("afterDeinit",function(t,i){if(i.settings.presentationMode.use)try{n.parent&&n.parent!==n&&n.parent.postMessage(JSON.stringify({type:"afterDeinit"}),"*")}catch(r){e.error("Cannot post message to parent: "+r)}}),i("setActive",function(t,n){var i=e(n.delegatedFrom).attr("id"),r=n.substep,s=n.reason;e.each(n.current.selectMessageListeners,function(t,o){try{var a={type:"select",targetId:i,substep:r,reason:s};e.each(n.settings.presentationMode.transferredValues,function(e,t){a[t]=n.current[t]}),o.postMessage(JSON.stringify(a),"*")}catch(l){e.error("Cannot post message to listener: "+l)}})}),i("register","presentationPopup",function(){function t(){r.jmpress("current").presentationPopupTimeout=setTimeout(t,100);try{i.postMessage(JSON.stringify({type:"url",url:n.location.href,notesUrl:r.jmpress("settings").presentationMode.notesUrl}),"*")}catch(e){}}var i,r=e(this);r.jmpress("settings").presentationMode.use&&(i=n.open(e(this).jmpress("settings").presentationMode.url),r.jmpress("current").presentationPopupTimeout=setTimeout(t,100))})}(e,document,window)}),require.config({paths:{jquery:"http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min",ga:"http://www.google-analytics.com/ga.js",jmpress:"lib/jmpress/jmpress"}}),requirejs(["jquery","jmpress"],function(e){e(function(){e.jmpress("template","mytemplate",{x:0,y:-1e3,scale:1,children:function(e){return{y:400+100*e,x:-300+100*e,z:0-500*e,template:"mytemplate",scale:.3}}}),e.jmpress("template","basic",{x:0,y:0,scale:1,children:function(e){return{x:0+1e3*e,template:"basic",scale:1}}}),e("#jmpress").jmpress({fullscreen:!0})})}),define("sqt_about",function(){})})();